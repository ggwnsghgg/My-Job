## 2025-09-15 작업 정리

### Hometax 매칭 UI 개선 (linkup-etax)
- 선택 변경 시 제안 재생성 분리: 왼쪽 카드 선택 시에는 기존 제안만 조회, "Refresh Suggestions" 버튼에서만 삭제/재생성 수행
- 초기 자동 선택 제거: 초기 진입 시 첫 카드 자동 선택으로 인한 불필요 조회 방지
- 카드 클릭 오류 수정: Owl 이벤트 핸들러가 Promise로 평가되던 문제 해결
  - `t-on-click.prevent="selectLine(l.id)"` → `t-on-click.prevent="() => selectLine(l.id)"` (Match 버튼도 동일)
- 관련 파일
  - `custom/linkup-package/linkup-etax/lu_etax/static/src/js/etax_reconcile_client_action.js`
  - `custom/linkup-package/linkup-etax/lu_etax/static/src/xml/etax_reconcile_client_action.xml`

### Price List 보고서 로직/로그 개선 (Kim's Asia)
- 재고/유통기한 포함 기준 정교화
  - 수량: 예약 고려한 실가용 수량(free_qty) 기반으로 판단
  - 유통기한: `stock.lot`의 `use_date`/`removal_date`를 기준으로 유효 로트가 존재할 때만 포함
- 옵션 플래그 추가(컨텍스트/데이터 지원)
  - `ka_ignore_expiry`: 유통기한 무시
  - `ka_include_zero_stock`: 재고 0도 포함
- 로깅 개선: INFO 레벨로 핵심 판단 단계 로그 출력(`[Pricelist]`)
- 안정성 개선: `filtered('removal_date')` 체인을 제거하고 파이썬 필터로 대체하여 커서 닫힘 이슈 방지
- 관련 파일
  - `custom/20240501-Kim-s-Asia/ka_website_sale/report/product_pricelist_report.py`
- 옵션 사용 예시: `{'ka_ignore_expiry': True, 'ka_include_zero_stock': True}`

### 메모
- 필요 시 메뉴 액션 컨텍스트에 위 옵션을 기본값으로 설정 가능합니다.
- Price list 포함 기준은 카테고리, 공급사 등으로 확장 가능합니다.
